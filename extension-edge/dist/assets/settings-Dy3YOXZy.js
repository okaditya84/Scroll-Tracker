const c="scrollwise-settings",o={blocklist:[],dataRetentionDays:30},a=e=>{if(!e)return"";let t=e.trim().toLowerCase();if(!t)return"";/^https?:\/\//.test(t)||(t=`https://${t}`);try{return new URL(t).hostname.replace(/^www\./,"")}catch{return t.replace(/^https?:\/\//,"").replace(/^www\./,"").split("/")[0].trim()}},s=e=>{const t=Number.isFinite(e)?Math.round(e):o.dataRetentionDays;return Math.max(1,Math.min(365,t))},i=e=>Array.from(new Set(e.filter(Boolean))),y=(e,t)=>{const n={blocklist:e.blocklist,dataRetentionDays:e.dataRetentionDays};return t.blocklist&&(n.blocklist=i(t.blocklist.map(a).concat(e.blocklist)).filter(Boolean)),typeof t.dataRetentionDays<"u"&&(n.dataRetentionDays=s(t.dataRetentionDays)),{blocklist:i(n.blocklist.map(a)).filter(Boolean),dataRetentionDays:s(n.dataRetentionDays)}},l=async e=>{const t={blocklist:i(e.blocklist.map(a)).filter(Boolean),dataRetentionDays:s(e.dataRetentionDays)};return await chrome.storage.local.set({[c]:t}),t},r=async()=>{const t=(await chrome.storage.local.get(c))[c];return t?{blocklist:i((t.blocklist??o.blocklist).map(a)).filter(Boolean),dataRetentionDays:s(t.dataRetentionDays??o.dataRetentionDays)}:o},k=async e=>{const t=await r(),n=y(t,e);return l(n)},m=async e=>{const t=a(e);if(!t)return r();const n=await r();return n.blocklist.includes(t)?n:l({blocklist:[...n.blocklist,t],dataRetentionDays:n.dataRetentionDays})},u=async e=>{const t=a(e),n=await r();return n.blocklist.includes(t)?l({blocklist:n.blocklist.filter(d=>d!==t),dataRetentionDays:n.dataRetentionDays}):n},R=async()=>l(o);export{m as a,R as b,r as g,u as r,k as s};
