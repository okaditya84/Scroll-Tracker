const c="scrollwise-auth",t=async()=>(await chrome.storage.local.get(c))[c],r=async a=>{const e={trackingEnabled:!1,...await t()},s={accessToken:a.accessToken??e.accessToken,refreshToken:a.refreshToken??e.refreshToken,user:a.user?{...e.user,...a.user}:e.user,trackingEnabled:a.trackingEnabled??e.trackingEnabled};return await chrome.storage.local.set({[c]:s}),s},l=async()=>{await chrome.storage.local.remove(c)},i=async a=>{await r({trackingEnabled:a}),await o()},o=async()=>{const a=await t(),e=!!(a!=null&&a.trackingEnabled&&(a!=null&&a.accessToken)),s=await chrome.tabs.query({url:"<all_urls>"});await Promise.all(s.map(n=>n.id?chrome.tabs.sendMessage(n.id,{type:"SYNC_TRACKING",enabled:e}).catch(()=>{}):Promise.resolve()))};export{r as a,l as c,t as g,o as s,i as u};
